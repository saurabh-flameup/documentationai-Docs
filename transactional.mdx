---
title: Transactional Messaging
description: Send one-off messages triggered by your application
---

## Overview

Transactional messages are one-off, API-triggered notifications sent in response to user actions. Unlike campaigns, they're immediate and personalized for specific moments.

<Callout kind="info">**Required Permission**: `campaigns:trigger` to send transactional messages.</Callout>

## When to Use Transactional Messages

<Columns cols={2}>
  <Card title="Transactional" icon="zap">
    **Use for immediate, user-triggered notifications:**
    - Order confirmations
    - Password resets
    - Payment receipts
    - Shipping updates
    - Account alerts
    - Verification codes
  </Card>
  <Card title="Campaigns" icon="send">
    **Use for automated, recurring messages:**
    - Welcome series
    - Re-engagement
    - Promotional offers
    - Weekly digests
    - Abandoned cart reminders
  </Card>
</Columns>

## Send a Transactional Message

Send a push notification to a specific user.

**Endpoint:** `POST /api/v1/workspaces/{workspace_id}/transactional/send`

<CodeGroup>
```javascript
async function sendTransactional(userId, templateId, data) {
  const response = await fetch(
    `https://api.flameup.ai/api/v1/workspaces/${WORKSPACE_ID}/transactional/send`,
    {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-API-Key': API_KEY
      },
      body: JSON.stringify({
        user_id: userId,
        template_id: templateId,
        data: data
      })
    }
  );

  return response.json();
}

// Example: Order confirmation
await sendTransactional('user_123', 'order_confirmation', {
  order_id: 'ORD-12345',
  total: '$99.99',
  items_count: 3,
  estimated_delivery: 'Jan 25, 2024'
});
```

```python
def send_transactional(user_id, template_id, data):
    response = requests.post(
        f'https://api.flameup.ai/api/v1/workspaces/{WORKSPACE_ID}/transactional/send',
        headers={
            'Content-Type': 'application/json',
            'X-API-Key': API_KEY
        },
        json={
            'user_id': user_id,
            'template_id': template_id,
            'data': data
        }
    )
    return response.json()

# Example: Order confirmation
send_transactional('user_123', 'order_confirmation', {
    'order_id': 'ORD-12345',
    'total': '$99.99',
    'items_count': 3,
    'estimated_delivery': 'Jan 25, 2024'
})
```

```bash
curl -X POST "https://api.flameup.ai/api/v1/workspaces/{workspace_id}/transactional/send" \
  -H "Content-Type: application/json" \
  -H "X-API-Key: your_api_key" \
  -d '{
    "user_id": "user_123",
    "template_id": "order_confirmation",
    "data": {
      "order_id": "ORD-12345",
      "total": "$99.99",
      "items_count": 3,
      "estimated_delivery": "Jan 25, 2024"
    }
  }'
```
</CodeGroup>

### Request Body

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `user_id` | string | Yes | The user's external_id or Flameup person_id |
| `template_id` | string | Yes* | ID of a pre-defined template |
| `template` | object | Yes* | Inline template (if no template_id) |
| `data` | object | No | Variables for template personalization |
| `platform` | string | No | Target platform: `ios`, `android`, `web`, or `all` |

*Either `template_id` or `template` is required.

### Inline Templates

Instead of using a pre-defined template, you can provide the message inline:

<CodeGroup>
```javascript
await fetch(
  `https://api.flameup.ai/api/v1/workspaces/${WORKSPACE_ID}/transactional/send`,
  {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'X-API-Key': API_KEY
    },
    body: JSON.stringify({
      user_id: 'user_123',
      template: {
        title: 'Your order has shipped!',
        body: 'Order #{{order_id}} is on its way. Track it now.',
        data: {
          action: 'track_order',
          order_id: '{{order_id}}'
        }
      },
      data: {
        order_id: 'ORD-12345'
      }
    })
  }
);
```

```python
requests.post(
    f'https://api.flameup.ai/api/v1/workspaces/{WORKSPACE_ID}/transactional/send',
    headers={
        'Content-Type': 'application/json',
        'X-API-Key': API_KEY
    },
    json={
        'user_id': 'user_123',
        'template': {
            'title': 'Your order has shipped!',
            'body': 'Order #{{order_id}} is on its way. Track it now.',
            'data': {
                'action': 'track_order',
                'order_id': '{{order_id}}'
            }
        },
        'data': {
            'order_id': 'ORD-12345'
        }
    }
)
```
</CodeGroup>

**Response:**

```json
{
  "success": true,
  "message_id": "msg_550e8400e29b41d4a716446655440000",
  "delivered_to": ["ios", "android"],
  "devices_count": 2
}
```

## Common Examples

<Tabs>
  <Tab title="Order Updates" icon="package">
    ```javascript
    // Order confirmation
    await sendTransactional('user_123', null, {
      template: {
        title: 'Order Confirmed!',
        body: 'Thanks for your order #{{order_id}}. Total: {{total}}',
        data: { action: 'view_order', order_id: '{{order_id}}' }
      },
      data: { order_id: 'ORD-12345', total: '$99.99' }
    });

    // Shipping notification
    await sendTransactional('user_123', null, {
      template: {
        title: 'Your order has shipped!',
        body: 'Track your package: {{tracking_number}}',
        data: { action: 'track', tracking: '{{tracking_number}}' }
      },
      data: { tracking_number: '1Z999AA10123456784' }
    });

    // Delivered notification
    await sendTransactional('user_123', null, {
      template: {
        title: 'Package delivered!',
        body: 'Your order #{{order_id}} has been delivered.',
        data: { action: 'rate_order', order_id: '{{order_id}}' }
      },
      data: { order_id: 'ORD-12345' }
    });
    ```
  </Tab>
  <Tab title="Account Security" icon="shield">
    ```javascript
    // Password reset
    await sendTransactional('user_123', null, {
      template: {
        title: 'Password Reset Request',
        body: 'Tap to reset your password. Link expires in 1 hour.',
        data: { action: 'reset_password', token: '{{reset_token}}' }
      },
      data: { reset_token: 'abc123xyz' }
    });

    // New login alert
    await sendTransactional('user_123', null, {
      template: {
        title: 'New Login Detected',
        body: 'New sign-in from {{device}} in {{location}}',
        data: { action: 'review_security' }
      },
      data: { device: 'Chrome on Windows', location: 'New York, US' }
    });

    // 2FA code
    await sendTransactional('user_123', null, {
      template: {
        title: 'Your verification code',
        body: 'Your code is {{code}}. It expires in 5 minutes.',
        data: {}
      },
      data: { code: '847291' }
    });
    ```
  </Tab>
  <Tab title="Payments" icon="credit-card">
    ```javascript
    // Payment successful
    await sendTransactional('user_123', null, {
      template: {
        title: 'Payment Received',
        body: 'We received your payment of {{amount}}. Thank you!',
        data: { action: 'view_receipt', payment_id: '{{payment_id}}' }
      },
      data: { amount: '$49.99', payment_id: 'pay_abc123' }
    });

    // Payment failed
    await sendTransactional('user_123', null, {
      template: {
        title: 'Payment Failed',
        body: 'Your payment of {{amount}} was declined. Please update your card.',
        data: { action: 'update_payment' }
      },
      data: { amount: '$49.99' }
    });

    // Subscription renewal
    await sendTransactional('user_123', null, {
      template: {
        title: 'Subscription Renewed',
        body: 'Your {{plan}} plan has been renewed for {{amount}}/month.',
        data: { action: 'view_subscription' }
      },
      data: { plan: 'Premium', amount: '$19.99' }
    });
    ```
  </Tab>
  <Tab title="Social" icon="users">
    ```javascript
    // New follower
    await sendTransactional('user_123', null, {
      template: {
        title: '{{follower_name}} is now following you',
        body: 'Tap to view their profile',
        data: { action: 'view_profile', user_id: '{{follower_id}}' }
      },
      data: { follower_name: 'John Doe', follower_id: 'user_456' }
    });

    // New message
    await sendTransactional('user_123', null, {
      template: {
        title: 'New message from {{sender_name}}',
        body: '{{message_preview}}',
        data: { action: 'open_chat', chat_id: '{{chat_id}}' }
      },
      data: {
        sender_name: 'Jane',
        message_preview: 'Hey, are you free for lunch?',
        chat_id: 'chat_789'
      }
    });

    // Comment on post
    await sendTransactional('user_123', null, {
      template: {
        title: '{{commenter_name}} commented on your post',
        body: '"{{comment_preview}}"',
        data: { action: 'view_post', post_id: '{{post_id}}' }
      },
      data: {
        commenter_name: 'Mike',
        comment_preview: 'Great point!',
        post_id: 'post_456'
      }
    });
    ```
  </Tab>
</Tabs>

## Targeting Specific Platforms

By default, transactional messages are sent to all of a user's registered devices. You can target specific platforms:

<CodeGroup>
```javascript
// Send only to iOS devices
await fetch(
  `https://api.flameup.ai/api/v1/workspaces/${WORKSPACE_ID}/transactional/send`,
  {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'X-API-Key': API_KEY
    },
    body: JSON.stringify({
      user_id: 'user_123',
      platform: 'ios',  // or 'android', 'web', 'all'
      template: {
        title: 'iOS Only Notification',
        body: 'This goes to iOS devices only'
      }
    })
  }
);
```

```bash
curl -X POST "https://api.flameup.ai/api/v1/workspaces/{workspace_id}/transactional/send" \
  -H "Content-Type: application/json" \
  -H "X-API-Key: your_api_key" \
  -d '{
    "user_id": "user_123",
    "platform": "ios",
    "template": {
      "title": "iOS Only Notification",
      "body": "This goes to iOS devices only"
    }
  }'
```
</CodeGroup>

## Push Notification Options

Customize the push notification behavior:

```javascript
await fetch(
  `https://api.flameup.ai/api/v1/workspaces/${WORKSPACE_ID}/transactional/send`,
  {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'X-API-Key': API_KEY
    },
    body: JSON.stringify({
      user_id: 'user_123',
      template: {
        title: 'Important Update',
        body: 'Please review your account',

        // iOS-specific options
        ios: {
          badge: 1,
          sound: 'default',
          category: 'ACCOUNT_ALERT'
        },

        // Android-specific options
        android: {
          channel_id: 'important_updates',
          priority: 'high',
          icon: 'ic_notification'
        },

        // Custom data payload
        data: {
          action: 'review_account',
          deep_link: '/account/security'
        }
      }
    })
  }
);
```

### Platform-Specific Options

| Platform | Option | Description |
|----------|--------|-------------|
| iOS | `badge` | App badge count |
| iOS | `sound` | Notification sound |
| iOS | `category` | Action category for interactive notifications |
| Android | `channel_id` | Notification channel |
| Android | `priority` | `high`, `normal`, or `low` |
| Android | `icon` | Notification icon resource |

## Error Handling

<Callout kind="warning">Handle these common error cases in your integration.</Callout>

### User Not Found

```json
{
  "success": false,
  "error": {
    "code": "user_not_found",
    "message": "No user found with the provided ID"
  }
}
```

### No Devices Registered

```json
{
  "success": false,
  "error": {
    "code": "no_devices",
    "message": "User has no registered devices for the target platform"
  }
}
```

### Template Not Found

```json
{
  "success": false,
  "error": {
    "code": "template_not_found",
    "message": "Template 'order_confirmation' not found"
  }
}
```

### Handling in Code

```javascript
async function sendNotification(userId, template, data) {
  try {
    const response = await fetch(
      `${BASE_URL}/transactional/send`,
      {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'X-API-Key': API_KEY
        },
        body: JSON.stringify({
          user_id: userId,
          template,
          data
        })
      }
    );

    const result = await response.json();

    if (!result.success) {
      switch (result.error.code) {
        case 'user_not_found':
          console.log('User not found in Flameup');
          break;
        case 'no_devices':
          console.log('User has no push-enabled devices');
          break;
        default:
          console.error('Push failed:', result.error.message);
      }
      return null;
    }

    return result;
  } catch (error) {
    console.error('Network error:', error);
    throw error;
  }
}
```

## Best Practices

<ExpandableGroup>
  <Expandable title="Keep Messages Actionable" default-open="true">
    Every transactional message should have a clear purpose and action:
    - Use clear, specific titles
    - Include relevant details in the body
    - Provide deep links for quick actions
  </Expandable>
  <Expandable title="Handle Failures Gracefully" default-open="false">
    Not all users will have push enabled. Your app should:
    - Check if the notification was delivered
    - Have fallback communication channels (email, in-app)
    - Not block critical flows on push success
  </Expandable>
  <Expandable title="Respect User Preferences" default-open="false">
    Even for transactional messages:
    - Honor notification preferences
    - Don't over-notify for minor events
    - Consolidate related notifications when possible
  </Expandable>
  <Expandable title="Use Templates for Consistency" default-open="false">
    Create templates for common message types:
    - Ensures consistent branding
    - Easier to update across your app
    - Reduces API payload size
  </Expandable>
</ExpandableGroup>
